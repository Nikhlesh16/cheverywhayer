# ========================================
# BACKEND ENVIRONMENT VARIABLES
# ========================================

# ========================================
# DATABASE (PostgreSQL) - REQUIRED
# ========================================

# PostgreSQL Connection String
# Format: postgresql://username:password@hostname:port/database

# LOCAL DOCKER:
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/hyperlocal_db

# SUPABASE (Recommended for free tier):
# Get from: Supabase Dashboard > Settings > Database > Connection String (URI)
# Format: postgresql://postgres.[ref]:[password]@aws-0-[region].pooler.supabase.com:5432/postgres
# Example: DATABASE_URL=postgresql://postgres.xxxxx:your-password@aws-0-us-east-1.pooler.supabase.com:5432/postgres

# RAILWAY (Auto-provided when you add PostgreSQL plugin):
# Use variable reference: ${{Postgres.DATABASE_URL}}

# RENDER (From Render PostgreSQL dashboard):
# External Database URL: postgresql://user:password@hostname/database

# NEON (Serverless Postgres):
# Format: postgresql://user:password@ep-xxx.region.aws.neon.tech/dbname

# ========================================
# REDIS CACHE - REQUIRED
# ========================================

# Option 1: REDIS_URL (Recommended for cloud deployments)
# Use this for: Upstash, Railway Redis, Render Redis, etc.

# UPSTASH (Recommended - Free tier: 10k commands/day):
# Get from: Upstash Console > Database > .env section
# ⚠️ IMPORTANT: Use rediss:// (double 's') for TLS
# Format: rediss://default:[password]@[region].upstash.io:[port]
# Example: REDIS_URL=rediss://default:AxxxZzQ@us1-capital-firefly-12345.upstash.io:6379
REDIS_URL=

# Option 2: Individual Redis Config (For local Docker only)
# These are ignored if REDIS_URL is set
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=

# ========================================
# JWT AUTHENTICATION - REQUIRED
# ========================================

# Secret key for signing JWT tokens
# ⚠️ CRITICAL: Change this in production!
# Generate secure key: openssl rand -base64 32
JWT_SECRET=your-super-secret-jwt-key-change-in-production

# JWT expiration time
# Examples: 7d (7 days), 24h (24 hours), 30m (30 minutes)
JWT_EXPIRATION=7d

# ========================================
# SERVER CONFIGURATION
# ========================================

# Port number for backend server
# Local: 3001
# Railway/Render: Use their auto-assigned PORT
# Fly.io: Usually 8080
PORT=3001

# Node environment
# Values: development, production, test
NODE_ENV=development

# ========================================
# CORS & FRONTEND URLS - REQUIRED
# ========================================

# Comma-separated list of allowed origins for CORS
# Supports wildcards (*) for subdomains

# LOCAL DEVELOPMENT:
CORS_ORIGINS=http://localhost:3000

# PRODUCTION EXAMPLES:
# Single domain:
# CORS_ORIGINS=https://your-app.vercel.app

# Multiple domains:
# CORS_ORIGINS=https://your-app.vercel.app,https://www.yourdomain.com

# Vercel with preview deployments (recommended):
# CORS_ORIGINS=https://your-app.vercel.app,https://your-app-*.vercel.app,https://*.vercel.app

# Allow all (NOT RECOMMENDED for production):
# CORS_ORIGINS=*

# ========================================
# H3 GEOSPATIAL CONFIGURATION
# ========================================

# H3 hexagon resolution (affects region size)
# 7 = ~22 km hexagons (larger regions)
# 8 = ~5 km hexagons (recommended default)
# 9 = ~1.2 km hexagons (smaller, more regions)
# See: https://h3geo.org/docs/core-library/restable/
H3_RESOLUTION=8

# ========================================
# FILE STORAGE (Optional)
# ========================================

# Option 1: AWS S3
# S3_BUCKET=your-bucket-name
# S3_REGION=us-east-1
# S3_ACCESS_KEY_ID=AKIA...
# S3_SECRET_ACCESS_KEY=your-secret-key
# S3_ENDPOINT=https://s3.us-east-1.amazonaws.com

# Option 2: Cloudinary
# CLOUDINARY_URL=cloudinary://api_key:api_secret@cloud_name
# CLOUDINARY_UPLOAD_PRESET=your-preset

# Option 3: Supabase Storage (Recommended if using Supabase DB)
# SUPABASE_URL=https://xxxxx.supabase.co
# SUPABASE_SERVICE_ROLE_KEY=eyJhbGc...
# SUPABASE_STORAGE_BUCKET=uploads

# Option 4: Vercel Blob (if deploying to Vercel)
# BLOB_READ_WRITE_TOKEN=vercel_blob_rw_...

# ========================================
# EMAIL (Optional - for future features)
# ========================================

# SendGrid
# SENDGRID_API_KEY=SG.xxxxx
# SENDGRID_FROM_EMAIL=noreply@yourdomain.com

# Resend
# RESEND_API_KEY=re_xxxxx
# RESEND_FROM_EMAIL=noreply@yourdomain.com

# AWS SES
# AWS_SES_REGION=us-east-1
# AWS_SES_ACCESS_KEY_ID=AKIA...
# AWS_SES_SECRET_ACCESS_KEY=...

# ========================================
# MONITORING (Optional)
# ========================================

# Sentry for error tracking
# SENTRY_DSN=https://xxxxx@sentry.io/xxxxx
# SENTRY_ENVIRONMENT=production

# LogRocket for session replay
# LOGROCKET_APP_ID=your-app-id/project-name

# ========================================
# RATE LIMITING (Optional)
# ========================================

# Requests per minute per IP
# RATE_LIMIT_MAX=100

# Rate limit window in minutes
# RATE_LIMIT_WINDOW=1

# ========================================
# PLATFORM-SPECIFIC NOTES
# ========================================

# RAILWAY:
# 1. Add PostgreSQL plugin → DATABASE_URL auto-provided
# 2. Add Redis plugin → REDIS_URL auto-provided  
# 3. Reference with: ${{Postgres.DATABASE_URL}}
# 4. All other vars: add manually in Variables tab

# RENDER:
# 1. Create PostgreSQL database → copy External URL
# 2. Use Upstash for Redis → copy REDIS_URL
# 3. Add vars in Web Service → Environment tab
# 4. PORT is auto-provided by Render (usually 10000)

# FLY.IO:
# 1. Create services: fly postgres create, fly redis create
# 2. Set secrets: fly secrets set KEY=value
# 3. Secrets are encrypted and auto-injected
# 4. Don't commit .env to git on Fly.io

# SUPABASE + UPSTASH (Best free tier combo):
# 1. Supabase: 500MB DB, unlimited requests
# 2. Upstash: 10k Redis commands/day
# 3. Both have generous free tiers
# 4. Production-ready with backups

# VERCEL (NOT for backend - use for frontend only)
# Vercel is for frontend. Deploy backend to:
# - Railway (easiest)
# - Render (good free tier)
# - Fly.io (best for advanced users)

# ========================================
# SECURITY CHECKLIST
# ========================================
# ✅ Change JWT_SECRET to a strong random value
# ✅ Use TLS for Redis (rediss://) in production
# ✅ Use SSL for PostgreSQL (?sslmode=require)
# ✅ Don't commit .env files to git (.gitignore them)
# ✅ Rotate secrets regularly
# ✅ Use different secrets for dev/staging/prod
# ✅ Enable 2FA on all cloud provider accounts
